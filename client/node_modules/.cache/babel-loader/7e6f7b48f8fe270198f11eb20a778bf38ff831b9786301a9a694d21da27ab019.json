{"ast":null,"code":"import _regeneratorRuntime from\"/Users/milan/ReelsFrontEnd/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/milan/ReelsFrontEnd/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/milan/ReelsFrontEnd/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import Videos from'./Videos';import'./Feed.css';import{useContext}from'react';import Authcontext from'../AuthContextProvider';import{Navigate}from'react-router';import{Input}from'@mui/material';import{Button}from'@mui/material';import axios from'axios';import api from'../../utility';import{useState,useEffect}from'react';import{CircularProgress}from'@mui/material';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Feed(){var userData=useContext(Authcontext);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),uploading=_useState8[0],setUploading=_useState8[1];var callback=function callback(enteries){enteries.forEach(function(entry){var ele=entry.target.childNodes[0].childNodes[0].childNodes[0];entry.target.childNodes[0].childNodes[1].setAttribute('class','hidden');console.log(ele);ele.play().then(function(){if(!ele.paused&&!entry.isIntersecting){ele.currentTime=0;ele.pause();}});});};var observer=new IntersectionObserver(callback,{threshold:0.5});useEffect(function(){var elements=document.querySelectorAll(\".video\");elements.forEach(function(element){observer.observe(element);});});useEffect(function(){setLoading(true);function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return api.get(\"/post/getAllPost\");case 2:res=_context.sent;console.log(res);if(res.status>=200&&res.status<=299){setPosts(res.data.data);setLoading(false);}else if(res.status===401){setError(\"There Might Be Some Error While Fetching Data\");setLoading(false);}else if(res.status===501){setError(\"Internal Error\");setLoading(false);}case 5:case\"end\":return _context.stop();}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);var handleUploadVideo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var file,data,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setUploading(true);_context2.prev=1;file=document.querySelector(\"#video\").files[0];data=new FormData();data.append(\"video\",file);_context2.next=7;return api.post(\"/videouplaod\",data,{headers:{\"Content-Type\":\"multipart/form-data\"},withCredentials:true});case 7:res=_context2.sent;if(res.status===201){window.alert(\"Added Video\");setUploading(false);}else{window.alert(\"Unable To Add Video\");setUploading(false);}_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);window.alert(_context2.t0.message);case 14:case\"end\":return _context2.stop();}},_callee2,null,[[1,11]]);}));return function handleUploadVideo(_x){return _ref.apply(this,arguments);};}();var handleUploadButtonClick=function handleUploadButtonClick(){console.log(document.querySelector(\".upload\").childNodes[0]);document.querySelector(\".upload\").childNodes[0].click();};return userData.user?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full h-full justify-center items-center mt-8\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(Input,{onChange:handleUploadVideo,className:\"upload hidden\",type:\"file\",id:\"video\",variant:\"outlined\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",className:\"mb-2 w-64 h-12\",onClick:handleUploadButtonClick,disabled:uploading,children:!uploading?\"Upload\":\"Uploading...\"})]})}),loading?/*#__PURE__*/_jsx(CircularProgress,{}):posts?/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col justify-between items-center videocontainer\",children:posts.map(function(post){return/*#__PURE__*/_jsx(\"div\",{className:\"video\",children:/*#__PURE__*/_jsx(Videos,{post:post})});})}):/*#__PURE__*/_jsx(\"div\",{})]}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}export default Feed;","map":{"version":3,"names":["React","Videos","useContext","Authcontext","Navigate","Input","Button","axios","api","useState","useEffect","CircularProgress","jsx","_jsx","jsxs","_jsxs","Feed","userData","_useState","_useState2","_slicedToArray","posts","setPosts","_useState3","_useState4","loading","setLoading","_useState5","undefined","_useState6","error","setError","_useState7","_useState8","uploading","setUploading","callback","enteries","forEach","entry","ele","target","childNodes","setAttribute","console","log","play","then","paused","isIntersecting","currentTime","pause","observer","IntersectionObserver","threshold","elements","document","querySelectorAll","element","observe","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","wrap","_callee$","_context","prev","next","get","sent","status","data","stop","handleUploadVideo","_ref","_callee2","e","file","_callee2$","_context2","querySelector","files","FormData","append","post","headers","withCredentials","window","alert","t0","message","_x","handleUploadButtonClick","click","user","className","children","encType","onChange","type","id","variant","onClick","disabled","map","to"],"sources":["/Users/milan/ReelsFrontEnd/client/src/Components/Feed/Feed.jsx"],"sourcesContent":["import React from 'react'\nimport Videos from './Videos';\nimport './Feed.css'\nimport { useContext } from 'react';\nimport Authcontext from '../AuthContextProvider';\nimport { Navigate } from 'react-router';\nimport { Input } from '@mui/material';\nimport { Button } from '@mui/material'\nimport axios from 'axios';\nimport api from '../../utility'\nimport { useState, useEffect } from 'react';\nimport { CircularProgress } from '@mui/material';\nfunction Feed() {\n    const userData = useContext(Authcontext);\n    const [posts, setPosts] = useState(\"\");\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(undefined);\n    const [uploading,setUploading] = useState(false);\n    const callback = (enteries) => {\n        enteries.forEach(entry => {\n            let ele = entry.target.childNodes[0].childNodes[0].childNodes[0];\n            entry.target.childNodes[0].childNodes[1].setAttribute('class','hidden');\n            console.log(ele);\n            ele.play().then(() => {\n                if (!ele.paused && !entry.isIntersecting) {\n                    ele.currentTime = 0;\n                    ele.pause();\n                }\n            })\n        })\n    }\n    let observer = new IntersectionObserver(callback, { threshold: 0.5 });\n    useEffect(() => {\n        const elements = document.querySelectorAll(\".video\");\n        elements.forEach(element => {\n            observer.observe(element);\n        })\n    });\n    useEffect(() => {\n        setLoading(true);\n        async function fetchData() {\n            const res = await api.get(\"/post/getAllPost\");\n            console.log(res);\n            if (res.status >= 200 && res.status <= 299) {\n                setPosts(res.data.data);\n                setLoading(false);\n            } else if (res.status === 401) {\n                setError(\"There Might Be Some Error While Fetching Data\");\n                setLoading(false);\n            } else if (res.status === 501) {\n                setError(\"Internal Error\");\n                setLoading(false);\n            }\n        }\n        fetchData();\n    }, [])\n    const handleUploadVideo = async (e) => {\n        setUploading(true);\n        try {\n            const file = document.querySelector(\"#video\").files[0];\n            const data = new FormData();\n            data.append(\"video\", file);\n            const res = await api.post(\"/videouplaod\", data, {\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\",\n                },\n                withCredentials: true\n            });\n            if (res.status === 201) {\n                window.alert(\"Added Video\");\n                setUploading(false);\n            } else {\n                window.alert(\"Unable To Add Video\");\n                setUploading(false);\n            }\n        } catch (err) {\n            window.alert(err.message);\n        }\n    }\n    const handleUploadButtonClick = () => {\n        console.log(document.querySelector(\".upload\").childNodes[0]);\n        document.querySelector(\".upload\").childNodes[0].click();\n    }\n    return (\n        userData.user ? <div className='flex flex-col w-full h-full justify-center items-center mt-8'>\n            <div>\n                <form encType=\"multipart/form-data\">\n                    <Input onChange={handleUploadVideo} className = 'upload hidden' type='file' id=\"video\" variant='outlined'></Input>\n                    <Button variant = \"outlined\" className = 'mb-2 w-64 h-12' onClick={handleUploadButtonClick} disabled={uploading}>{!uploading ? \"Upload\" : \"Uploading...\"}</Button>\n                </form>\n            </div>\n            {loading ? <CircularProgress />:\n                posts ? <div className='flex flex-col justify-between items-center videocontainer'>\n                    {posts.map(post => {\n                        return (\n                            <div className='video'>\n                                <Videos post={post}></Videos>\n                            </div>\n                        )\n\n                    })}\n                </div> : <div></div>}\n        </div> : <Navigate to='/login'></Navigate>\n    )\n}\n\nexport default Feed"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}